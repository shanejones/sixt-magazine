<?php
$map_locations = [
    [
        'title' => 'Aix-en-Provence est la ville la plus calme de France',
        'description' => '<p>Située au cœur de la Provence, Aix-en-Provence arrive en tête du classement des villes les plus calmes, notamment grâce aux avis des visiteurs. Une portion significative des avis laissés sur les trois principales attractions de la ville mentionnent des mots comme « paisible » ou « calme », démontrant son attrait pour ceux qui recherchent un cadre relaxant. En plus, avec une densité de population relativement faible (789 habitants/km²), la ville offre une ambiance plus détendue que les grandes métropoles françaises.</p><p>Réputée pour ses sources thermales, ses paysages verdoyants et son rythme de vie plus lent, Aix-en-Provence séduit par ses grandes avenues bordées de fontaines et de platanes, idéales pour se détendre sous le soleil méditerranéen. Si vous prévoyez <a href="https://www.sixt.fr/magazine/week-end/week-end-sud-de-la-france/" target="_blank">votre week-end dans le sud de la France</a>, pensez à louer une voiture pour explorer les trésors de la région en toute liberté.</p>',
        'image' => plugin_dir_url( __FILE__ ) . 'map-images/1-aix-en-provence.jpg'
    ],
    [
        'title' => 'Tours est l\'une des villes les plus vertes de France',
        'description' => '<p>Nichée dans la vallée de la Loire, Tours séduit par son architecture élégante, ses rivières et son atmosphère paisible. Elle se distingue par une excellente densité de parcs et jardins, offrant une qualité remarquable des espaces verts.</p><p>Grâce à un trafic fluide et des temps de trajet raisonnables, la ville reste accessible et agréable. Moins congestionnée que d\'autres, et fortement engagée dans la préservation de ses espaces naturels, Tours est parfaite pour ceux qui souhaitent s\'évader du bruit urbain. Les nombreux jardins et parcs disséminés dans la ville en font un lieu de prédilection pour la détente.</p>
',
        'image' => plugin_dir_url( __FILE__ ) . 'map-images/2-tours.jpg'
    ],
    [
        'title' => 'Angers est la ville idéale pour une escapade paisible',
        'description' => '<p>Angers allie dynamisme et sérénité, faisant d\'elle l\'une des destinations les plus apaisantes de France. Avec une excellente qualité des espaces verts (91,67/100), elle offre un cadre propice à la détente, entre balades dans les parcs, flâneries le long de la Maine ou visite de son célèbre château (envie de découvrir d\'autres <a href="https://www.sixt.fr/magazine/voyages/les-plus-beaux-chateaux-de-france/" target="_blank">châteaux</a> incroyables à travers la France ? Ne manquez pas notre guide des châteaux). De plus, la faible densité du trafic implique un temps de trajet moyen de seulement 16 minutes pour 10 km, facilitant ainsi une mobilité sans stress, ainsi que son faible taux de congestion (seulement 40 heures perdues par an dans les embouteillages, contre 113 heures à Bordeaux) en font une destination idéale pour se reposer.</p>',
        'image' => plugin_dir_url( __FILE__ ) . 'map-images/3-angers.jpg'
    ],
    [
        'title' => 'Reims est la capitale du champagne et du calme',
        'description' => '<p>Bien qu\'elle soit souvent associée au champagne, Reims est aussi une ville où l\'on peut véritablement profiter du calme. Avec une bonne qualité des espaces verts (75/100) et une pollution sonore réduite grâce à son réseau de transport efficace, Reims reste à l\'abri des nuisances sonores des grandes villes. Sa densité de population modérée (4 191 habitants/km²) et la présence de vastes jardins publics offrent un cadre reposant pour les habitants et les visiteurs.</p>',
        'image' => plugin_dir_url( __FILE__ ) . 'map-images/4-reims.jpg'
    ],
    [
        'title' => 'Le Havre se distingue par sa faible pollution sonore et lumineuse',
        'description' => '<p>Située en Normandie, Le Havre surprend par son ambiance apaisante, renforcée par un faible niveau de bruit et une pollution lumineuse très basse. Ces éléments participent à une atmosphère plus sereine qu\'on ne l\'imagine pour une grande ville portuaire.</p><p>Malgré une densité relativement élevée, son cadre en bord de mer et ses infrastructures modernes permettent de profiter d\'un rythme plus détendu. Le Havre séduit ainsi ceux qui recherchent un équilibre entre dynamisme urbain et tranquillité.</p>',
        'image' => plugin_dir_url( __FILE__ ) . 'map-images/5-le-havre.jpg'
    ],
    [
        'title' => 'Rennes est l\'une des villes les moins congestionnées de France',
        'description' => '<p>Rennes se distingue dans notre classement grâce à son faible niveau de congestion, le plus bas parmi toutes les villes analysées, ce qui contribue directement à une atmosphère plus calme et moins stressante. La ville bénéficie également d\'une faible pollution lumineuse (18,85 magnitudes par seconde d\'arc au carré) et d\'une proportion élevée d\'avis mentionnant un cadre « paisible » ou « tranquille » pour ses principales attractions.</p><p>Avec son centre historique à taille humaine, ses ruelles pittoresques, ses places calmes et des parcs comme le Thabor, Rennes séduit les voyageurs en quête de sérénité et d\'authenticité, loin de l\'agitation des grandes villes.</p>',
        'image' => plugin_dir_url( __FILE__ ) . 'map-images/6-rennes.jpg'
    ],
    [
        'title' => 'Nîmes se classe parmi les destinations plus détendue',
        'description' => '<p>Connue pour son riche patrimoine romain, Nîmes séduit aussi par la fluidité de ses déplacements. Avec seulement 39 heures passées dans les embouteillages par an, elle affiche le meilleur score national en matière de circulation.</p><p>Son temps de trajet moyen de 13 minutes pour 10 km permet de se déplacer facilement sans stress. Ajoutée à une densité de population modérée, cette accessibilité contribue à une atmosphère plus paisible, idéale pour ceux qui souhaitent découvrir le sud sans agitation.</p>',
        'image' => plugin_dir_url( __FILE__ ) . 'map-images/7-nimes.jpg'
    ],
    [
        'title' => 'Limoges est l\'une des villes les plus vertes et les plus tranquilles de France',
        'description' => '<p>Réputée pour sa porcelaine, Limoges séduit également par la qualité de son environnement urbain. Avec une très faible densité de population et une pollution lumineuse parmi les plus faibles de notre classement, la ville offre un véritable havre de paix.</p><p>Son atmosphère est rehaussée par de superbes espaces verts et un mode de vie doux qui invite naturellement à la détente. Idéale pour ralentir le rythme, Limoges est la destination parfaite pour se reposer et profiter pleinement d\'un environnement apaisant.</p>',
        'image' => plugin_dir_url( __FILE__ ) . 'map-images/8-limoges.jpg'
    ],
    [
        'title' => 'Saint Étienne bénéficie d\'une ambiance urbaine discrète et apaisée',
        'description' => '<p>Souvent sous-estimée, Saint-Étienne révèle une ambiance étonnamment paisible, portée par un faible niveau de pollution lumineuse qui adoucit le paysage urbain et crée une atmosphère plus sereine.</p><p>Avec une densité modérée et une circulation fluide, la ville permet de se déplacer facilement tout en profitant d\'un cadre calme. C\'est un lieu où l\'on peut apprécier les avantages de la ville tout en savourant un quotidien plus apaisé.</p>',
        'image' => plugin_dir_url( __FILE__ ) . 'map-images/9-saint-etienne.jpg'
    ],
    [
        'title' => 'Bayonne offre un cadre lumineux et paisible au quotidien',
        'description' => '<p>Ville du Pays basque, Bayonne séduit par son patrimoine, sa culture gastronomique et sa faible pollution lumineuse, qui contribue à une atmosphère apaisante, surtout le soir.</p><p>Avec un temps de trajet moyen de 13 minutes pour 10 km, les déplacements sont rapides et agréables. Son atmosphère et son rythme de vie détendu en font une destination idéale pour ceux qui veulent échapper à l\'agitation de la grande ville tout en restant actifs.</p>',
        'image' => plugin_dir_url( __FILE__ ) . 'map-images/10-bayonne.jpg'
    ],
];

$map_svg_url = plugin_dir_url( __FILE__ ) . 'map-images/french-map.svg';

$map_markers = [
    ['top' => '85%', 'left' => '77%'],
    ['top' => '39%', 'left' => '42%'],
    ['top' => '37%', 'left' => '33%'],
    ['top' => '18%', 'left' => '66%'],
    ['top' => '17%', 'left' => '38%'],
    ['top' => '31%', 'left' => '24%'],
    ['top' => '79%', 'left' => '69%'],
    ['top' => '59%', 'left' => '45%'],
    ['top' => '60%', 'left' => '68%'],
    ['top' => '84%', 'left' => '25%'],
];
?>

<div class="fr-qc-interactive-map-container">
    <div class="fr-qc-interactive-map-content">
        <?php foreach ( $map_locations as $index => $location ) : ?>
            <div class="fr-qc-map-location-item <?php echo $index === 0 ? 'active' : ''; ?>" data-location-index="<?php echo $index; ?>">
                <p class="fr-qc-map-location-item-number">#<?php echo $index + 1; ?></p>
                <h2><?php echo esc_html( $location['title'] ); ?></h2>
                <img src="<?php echo esc_url( $location['image'] ); ?>" alt="<?php echo esc_attr( $location['title'] ); ?>">
                <?php echo $location['description']; ?>
            </div>
        <?php endforeach; ?>
    </div>
    <div class="fr-qc-interactive-map-image">
        <?php
        
            echo '<img class="main-map" src="' . esc_url( $map_svg_url ) . '" alt="' . esc_attr__( 'Interactive Map of France', 'ra7-helper-plugin' ) . '">' ;
        
        ?>
        
        <div class="fr-qc-map-markers">
            <?php foreach ( $map_markers as $index => $position ) : ?>
                <button 
                    class="fr-qc-map-marker <?php echo $index === 0 ? 'active' : ''; ?>" 
                    data-index="<?php echo $index; ?>"
                    style="top: <?php echo $position['top']; ?>; left: <?php echo $position['left']; ?>;"
                >
                    <svg class="fr-qc-marker-icon" height="25" viewBox="0 0 83.24 99.65" width="25" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><clipPath id="a"><path d="m0 0h83.24v99.65h-83.24z"/></clipPath><g clip-path="url(#a)" fill="currentColor"><path d="m25.026 78.873c-33.326-15.218-33.66-61.681.741-75.741 26.171-10.68 55.965 7.109 57.414 35.848.934 18.424-9.244 32.467-26.106 40.513a9.816 9.816 0 0 0 -3.189 3.174q-6.023 8.378-11.757 16.726a.584.584 0 0 1 -.795.168.547.547 0 0 1 -.156-.152c-3.366-4.824-11.193-18.265-16.153-20.534m41.793-37.785a25.223 25.223 0 1 0 -25.218 24.85 25.038 25.038 0 0 0 25.218-24.85"/><path d="m113 94.862a16.823 16.823 0 1 1 -17.07 16.821 16.947 16.947 0 0 1 17.07-16.821" transform="translate(-71.388 -70.593)"/></g></svg>
                    <?php echo $index + 1; ?>
                </button>
            <?php endforeach; ?>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const markers = document.querySelectorAll('.fr-qc-map-marker');
    const contentItems = document.querySelectorAll('.fr-qc-map-location-item');
    
    markers.forEach(marker => {
        marker.addEventListener('click', function() {
            const index = this.getAttribute('data-index');
            
            // Update active marker
            markers.forEach(m => m.classList.remove('active'));
            this.classList.add('active');
            
            // Update active content
            contentItems.forEach(item => item.classList.remove('active'));
            contentItems[index].classList.add('active');
        });
    });
});
</script>